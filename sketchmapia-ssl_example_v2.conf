<VirtualHost *:443>
    ServerName sketchmapia.uni-muenster.de

    SSLEngine on
    SSLCertificateFile /etc/ssl/certs/sketchmapia.pem
    SSLCertificateKeyFile /etc/ssl/private/sketchmapia_key.pem

    ProxyPreserveHost On

    # Sketchmap analyser (main app)
    ProxyPass        / http://localhost:8000/
    ProxyPassReverse / http://localhost:8000/

    # Generalizations service
    ProxyPass        /generalizations/ http://localhost:8001/
    ProxyPassReverse /generalizations/ http://localhost:8001/

    # Completeness service
    ProxyPass        /completeness/ http://localhost:8002/
    ProxyPassReverse /completeness/ http://localhost:8002/

    # Qualitative relations service
    ProxyPass        /qualitativerelations/ http://localhost:8003/
    ProxyPassReverse /qualitativerelations/ http://localhost:8003/

    RequestHeader set X-Forwarded-Proto "https"
    RequestHeader set X-Forwarded-Port "443"

    Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-XSS-Protection "1; mode=block"

    SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1

    SSLHonorCipherOrder on
    SSLCipherSuite "ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256"

    SSLUseStapling on
    SSLOCSPProxyURL http://wwwproxy.uni-muenster.de:3128/

    ErrorLog ${APACHE_LOG_DIR}/sketchmapia_error.log
    CustomLog ${APACHE_LOG_DIR}/sketchmapia_access.log combined
</VirtualHost>

SSLStaplingReturnResponderErrors off
MaxRequestsPerChild 4000
SSLStaplingCache shmcb:/..../..../sslstaplingcache(512000)